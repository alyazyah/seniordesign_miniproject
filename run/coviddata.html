<!doctype html>
<html lang="en">
	<head>
  	<meta charset="utf-8">
  	<title>COVID-19 Miniproject | COVID Data</title>
  	<link rel="stylesheet" href="css/coviddata.css">
  	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">
  	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  	</head>
	<body class="fullscreen">
  		<div class="container" id="covidData"></div>
		<nav id="sidenav">
			<ul>
				<li><a href="home.html">Home</a></li>
				<li><a href="yourdata.html">Your Data</a></li>
				<li><a href="coviddata.html">COVID Data</a></li>
			</ul>
		</nav>

		<img src="images/menu.png" id="menuBtn">

		<script>
			fetch("https://api.covidtracking.com/v1/us/current.json")
  				.then(function (response) {
    				return response.json();
  				})
  				.then(function (data) {
    				appendData(data[0]);
  				})
 				.catch(function (err) {
    				console.log(err);
  				});
 			function appendData(data){
 				const mainContainer = document.getElementById("covidData");
 				const dataToDisp = ["date","dateChecked","totalTestResults","totalTestResultsIncrease","positive","positiveIncrease","recovered","negative","death","deathIncrease","hospitalizedCumulative","hospitalizedCurrently","hospitalizedIncrease"];

 				const covidData = dataToDisp.map(item => {
 					const d = (item === "date" || item === "dateChecked") ? (item === "date") ?`${data[item].toString().slice(-4,-2)}-${data[item].toString().slice(-2)}-${data[item].toString().slice(-8,-4)}`: `${new Date(data[item]).getMonth()+1}-${new Date(data[item]).getDate()}-${new Date(data[item]).getFullYear()}` : data[item].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
 					const elm = `
 					<div class="card">
 						<i class="icon fas fa-${dispText(item).icon}"></i>
 						<div>${dispText(item).str}</div>
 						<div class="dataText">
 							${d}
 						</div>
 					</div>`;
 					return elm;
 				});

 				mainContainer.innerHTML = covidData.join("");
 			}

 			function dispText(type){
 				let str = "";
 				let icon = "";

 				switch(type){
 					case "date": 
 						str = "Date";
 						icon = "calendar-alt";
 						break;
 					case "dateChecked": 
 						str = "Last update";
 						icon = "clock";
 						break;
 					case "totalTestResults": 
 						str = "Total test results";
 						icon = "vial";
 						break;
 					case "totalTestResultsIncrease": 
 						str = "New tests";
 						icon = "vial";
 						break;
 					case "positive": 
 						str = "Total positive tests";
 						icon = "plus";
 						break;
 					case "positiveIncrease": 
 						str = "New positive cases";
 						icon = "plus";
 						break;
 					case "recovered": 
 						str = "Total recovered";
 						icon = "hospital-user";
 						break;
 					case "negative": 
 						str = "Total negative tests";
 						icon = "minus";
 						break;
 					case "death": 
 						str = "Total Deaths";
 						icon = "skull-crossbones";
 						break;
 					case "deathIncrease": 
 						str = "New deaths";
 						icon = "skull-crossbones";
 						break;
 					case "hospitalizedCumulative": 
 						str = "Total hospitalized";
 						icon = "hospital-user";
 						break;
 					case "hospitalizedCurrently": 
 						str = "Currently hospitalized";
 						icon = "hospital-user";
 						break;
 					case "hospitalizedIncrease": 
 						str = "Newly hospitalized";
 						icon = "hospital-user";
 						break;
 					default: 
 						str = "NA";
 				}
 				return {str,icon}; 
 			}

			var menuBtn = document.getElementById("menuBtn");
			var sidenav = document.getElementById("sidenav");

			sidenav.style.right = "-250px";
			
			menuBtn.onclick = function() {
				if(sidenav.style.right=="-250px") {
					sidenav.style.right = "0px";
				} else {
					sidenav.style.right = "-250px";
				}
			}
		</script>
	</body>
</html>